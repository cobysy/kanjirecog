(function(t){function e(e){for(var n,s,o=e[0],u=e[1],h=e[2],l=0,f=[];l<o.length;l++)s=o[l],i[s]&&f.push(i[s][0]),i[s]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(t[n]=u[n]);c&&c(e);while(f.length)f.shift()();return a.push.apply(a,h||[]),r()}function r(){for(var t,e=0;e<a.length;e++){for(var r=a[e],n=!0,o=1;o<r.length;o++){var u=r[o];0!==i[u]&&(n=!1)}n&&(a.splice(e--,1),t=s(s.s=r[0]))}return t}var n={},i={index:0},a=[];function s(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=n,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(r,n,function(e){return t[e]}.bind(null,n));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/kanjirecog/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=e,o=o.slice();for(var h=0;h<o.length;h++)e(o[h]);var c=u;a.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("fb89")},"3b8d":function(t,e,r){},d678:function(t,e,r){"use strict";var n=r("3b8d"),i=r.n(n);i.a},fb89:function(t,e,r){"use strict";r.r(e);r("cadf"),r("551c"),r("097d");var n=r("2b0e"),i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"outer"},[r("div",{staticClass:"logo"}),r("div",{staticClass:"signature-pad"},[r("div",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],staticClass:"signature-pad-loading"},[t._v("\n            "+t._s(t.message)+"\n        ")]),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"signature-pad-main"},[r("div",{staticClass:"signature-pad--body"},[r("canvas",{ref:"signaturePadCanvas"})]),r("div",{staticClass:"signature-pad--footer"},[r("div",{staticClass:"signature-pad--actions"},[r("b-button-group",{ref:"actionsLeft",attrs:{size:"sm"}},[r("b-button",{attrs:{disabled:t.clearDisabled,variant:t.variant},on:{click:function(e){t.clear()}}},[t._v("CLEAR")]),r("b-button",{attrs:{disabled:t.undoDisabled,variant:t.variant},on:{click:function(e){t.undo()}}},[t._v("UNDO")])],1),r("b-button-group",{attrs:{size:"sm"}},[r("b-button",{ref:"algoMode",attrs:{variant:"700"}},[t._v(t._s(t.algoText))])],1)],1)]),r("div",{staticStyle:{height:"15px"}}),r("div",[r("b-button-group",{attrs:{size:"sm"}},t._l(t.kanjiResults1,function(e){return r("b-button",{key:e.index,attrs:{variant:t.variantOutline},on:{click:function(r){t.copyKanji(e.kanji)}}},[t._v("\n                        "+t._s(e.kanji)+"\n                    ")])})),r("div",{staticStyle:{height:"1px"}}),r("b-button-group",{attrs:{size:"sm"}},t._l(t.kanjiResults2,function(e){return r("b-button",{key:e.index,attrs:{variant:t.variantOutline},on:{click:function(r){t.copyKanji(e.kanji)}}},[t._v("\n                        "+t._s(e.kanji)+"\n                    ")])})),r("div",{staticStyle:{height:"1px"}}),r("b-button-group",{attrs:{size:"sm"}},t._l(t.kanjiResults3,function(e){return r("b-button",{key:e.index,attrs:{variant:t.variantOutline},on:{click:function(r){t.copyKanji(e.kanji)}}},[t._v("\n                        "+t._s(e.kanji)+"\n                    ")])}))],1)])])])},a=[],s=(r("34ef"),r("ac4d"),r("8a81"),r("ac6a"),r("c665")),o=r("dc0a"),u=r("aa9a"),h=r("d328"),c=r("11d9"),l=r("9ab4"),f=r("60a3"),v=r("65d2"),d=r("d7ac"),S=r.n(d),k=r("8afe"),O=(r("55dd"),r("f400"),r("6b54"),r("c5f6"),r("84b4"),function(){function t(e,r){Object(s["a"])(this,t),this.index=e,this.display=r}return Object(u["a"])(t,[{key:"isClose",value:function(e){return this===t.X||e===t.X||this===e||(this.index===(e.index+1)%8||(this.index+1)%8===e.index)}}],[{key:"fromString",value:function(e){var r=!0,n=!1,i=void 0;try{for(var a,s=t.directions[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var o=a.value;if(o.display===e)return o}}catch(t){n=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}throw new Error("Unknown direction ("+e+")")}},{key:"get",value:function(e,r,n,i,a){var s=n-e,o=i-r,u=Math.abs(s),h=Math.abs(o);if(u<a&&h<a)return t.X;if(u>h){var c=h>t.DIAGONAL_THRESHOLD*u>>8;return s>0?c?o<0?t.NE:t.SE:t.E:c?o<0?t.NW:t.SW:t.W}var l=u>t.DIAGONAL_THRESHOLD*h>>8;return o>0?l?s<0?t.SW:t.SE:t.S:l?s<0?t.NW:t.NE:t.N}}]),t}());O.N=new O(0,"↑"),O.NE=new O(1,"↗"),O.E=new O(2,"→"),O.SE=new O(3,"↘"),O.S=new O(4,"↓"),O.SW=new O(5,"↙"),O.W=new O(6,"←"),O.NW=new O(7,"↖"),O.X=new O(-1,"⚪"),O.directions=[O.N,O.NE,O.E,O.SE,O.S,O.SW,O.W,O.NW,O.X],O.DIRECTION_THRESHOLD=51,O.DIAGONAL_THRESHOLD=77;var y=function(){function t(e,r,n){Object(s["a"])(this,t),this.x=e,this.y=r,this.display=n}return Object(u["a"])(t,[{key:"isClose",value:function(t){return Math.abs(this.x-t.x)<=1&&Math.abs(this.y-t.y)<=1}}],[{key:"fromString",value:function(e){var r=!0,n=!1,i=void 0;try{for(var a,s=t.locations[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var o=a.value;if(o.display===e)return o}}catch(t){n=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}throw new Error("Unknown location ("+e+")")}},{key:"get",value:function(e,r){return e<85?r<85?t.NW:r<170?t.W:t.SW:e<170?r<85?t.N:r<170?t.MID:t.S:r<85?t.NE:r<170?t.E:t.SE}}]),t}();y.N=new y(1,0,"▀"),y.NE=new y(2,0,"▜"),y.E=new y(2,1,"▐"),y.SE=new y(2,2,"▟"),y.S=new y(1,2,"▄"),y.SW=new y(0,2,"▙"),y.W=new y(0,1,"▌"),y.NW=new y(0,0,"▛"),y.MID=new y(1,1,"█"),y.locations=[y.N,y.NE,y.E,y.SE,y.S,y.SW,y.W,y.NW,y.MID];var b=function(){function t(){Object(s["a"])(this,t)}return Object(u["a"])(t,[{key:"getDirection",value:function(){return O.get(this.startX,this.startY,this.endX,this.endY,O.DIRECTION_THRESHOLD)}},{key:"getDirectionNoThreshold",value:function(){return O.get(this.startX,this.startY,this.endX,this.endY,0)}},{key:"getMoveDirection",value:function(t){return O.get(t.endX,t.endY,this.startX,this.startY,O.DIRECTION_THRESHOLD)}},{key:"getStartLocation",value:function(){return y.get(this.startX,this.startY)}},{key:"getEndLocation",value:function(){return y.get(this.endX,this.endY)}},{key:"toString",value:function(){return"["+this.startX+","+this.startY+":"+this.endX+","+this.endY+"]"}}],[{key:"fromFloats",value:function(t,e,r,n){return this.fromInts(this.convert(t),this.convert(e),this.convert(r),this.convert(n))}},{key:"fromInts",value:function(t,e,r,n){if(t<0||t>255||e<0||e>255||r<0||r>255||n<0||n>255)throw new RangeError("Value out of range");var i=new this;return i.startX=t,i.startY=e,i.endX=r,i.endY=n,i}},{key:"convert",value:function(t){return Math.trunc(255*t+.49999)}}]),t}(),E=function(){function t(e){Object(s["a"])(this,t),this.remaining=e}return Object(u["a"])(t,[{key:"readLetter",value:function(){var e=0;while(1){if(e===this.remaining.length)return t.EOL;var r=this.remaining.charAt(e);if(" "!==r)return","===r||"-"===r||"+"===r||r>="0"&&r<="9"?t.NUMBER:(this.remaining=this.remaining.substring(e+1),r);e++}}},{key:"readNumber",value:function(){var t=0;while(1){if(t===this.remaining.length)throw new Error("Unexpected EOL before number");var e=this.remaining.charAt(t);if(","!==e&&" "!==e&&"+"!==e)break;t++}var r=t+1;while(1){if(r===this.remaining.length)break;var n=this.remaining.charAt(r);if("."!==n&&(n<"0"||n>"9"))break;r++}var i=this.remaining.substring(t,r);this.remaining=this.remaining.substring(r);var a=parseFloat(i);if(isNaN(a))throw new Error("Invalid number: "+i);return a}}]),t}();E.EOL="-1",E.NUMBER="-2";var g=function(){function t(){Object(s["a"])(this,t)}return Object(u["a"])(t,null,[{key:"fromSvgPath",value:function(e){var r=new t,n=new E(e),i=n.readLetter();if("M"!==i&&"m"!==i)throw new Error("Path must start with M");r.startX=n.readNumber(),r.startY=n.readNumber();var a=r.startX,s=r.startY,o="-1";t:while(1){var u=n.readLetter();if(u===E.NUMBER){if("-1"===o)throw new Error("Expecting command, not number");u=o}else o=u;switch(u){case E.EOL:break t;case"c":n.readNumber(),n.readNumber(),n.readNumber(),n.readNumber(),a+=n.readNumber(),s+=n.readNumber();break;case"C":n.readNumber(),n.readNumber(),n.readNumber(),n.readNumber(),a=n.readNumber(),s=n.readNumber();break;case"s":n.readNumber(),n.readNumber(),a+=n.readNumber(),s+=n.readNumber();break;case"S":n.readNumber(),n.readNumber(),a=n.readNumber(),s=n.readNumber();break;case"z":case"Z":a=r.startX,s=r.startY;break;default:throw new Error("Unexpected path command: "+u)}}return r.endX=a,r.endY=s,r}},{key:"fromFloats",value:function(e,r,n,i){var a=new t;return a.startX=e,a.endX=n,a.startY=r,a.endY=i,a}},{key:"normalise",value:function(t){var e=Number.MAX_VALUE,r=Number.MAX_VALUE,n=Number.MIN_VALUE,i=Number.MIN_VALUE,a=!0,s=!1,o=void 0;try{for(var u,h=t[Symbol.iterator]();!(a=(u=h.next()).done);a=!0){var c=u.value;c.startX<e&&(e=c.startX),c.startX>n&&(n=c.startX),c.startY<r&&(r=c.startY),c.startY>i&&(i=c.startY),c.endX<e&&(e=c.endX),c.endX>n&&(n=c.endX),c.endY<r&&(r=c.endY),c.endY>i&&(i=c.endY)}}catch(t){s=!0,o=t}finally{try{a||null==h.return||h.return()}finally{if(s)throw o}}if(Math.abs(e-n)<1e-10){var l=Math.abs(r-i);l<1e-10&&(l=.1),e-=l,n+=l}if(Math.abs(r-i)<1e-10){var f=Math.abs(e-n)/100;f<1e-10&&(f=.1),r-=f,i+=f}var v=Math.abs(e-n),d=Math.abs(r-i);if(v>5*d){var S=(v-d)/2;r-=S,i+=S}else if(d>5*v){var k=(d-v)/2;e-=k,n+=k}for(var O=[],y=0;y<t.length;y++)O[y]=b.fromFloats((t[y].startX-e)/(n-e),(t[y].startY-r)/(i-r),(t[y].endX-e)/(n-e),(t[y].endY-r)/(i-r));return O}}]),t}(),w=function t(e,r){Object(s["a"])(this,t),this.kanji=e,this.strokes=r},I=function(){function t(e){Object(s["a"])(this,t),this.kanji=e,this.finished=!1,this.comparers=new Map,this.loadingStrokes=[]}return Object(u["a"])(t,[{key:"addStroke",value:function(t){if(null==this.loadingStrokes)throw new Error("Cannot add strokes after loading");this.loadingStrokes.push(t)}},{key:"finish",value:function(){if(this.finished)throw new Error("Cannot finish more than once");var t=this.loadingStrokes;this.strokes=g.normalise(t),this.findDirections()}},{key:"findDirections",value:function(){this.strokeDirections=[],this.strokeStarts=[],this.strokeEnds=[];for(var t=0;t<this.strokes.length;t++)this.strokeDirections[t]=this.strokes[t].getDirection(),this.strokeStarts[t]=this.strokes[t].getStartLocation(),this.strokeEnds[t]=this.strokes[t].getEndLocation();this.moveDirections=[];for(var e=1;e<this.strokes.length;e++)this.moveDirections[e-1]=this.strokes[e].getMoveDirection(this.strokes[e-1]);this.finished=!0}},{key:"checkFinished",value:function(){if(!this.finished)throw new Error("Cannot call on unfinished kanji")}},{key:"getStrokeCount",value:function(){return this.checkFinished(),this.strokeDirections.length}},{key:"getStroke",value:function(t){if(null==this.strokes)throw new Error("Cannot call getStroke in this state");return this.strokes[t]}},{key:"getAllDirections",value:function(){for(var t="",e=0;e<this.strokeDirections.length;e++)e>0&&(t+=":",t+=this.moveDirections[e-1],t+=":"),t+=this.strokeStarts[e],t+=this.strokeDirections[e],t+=this.strokeEnds[e];return t}},{key:"getTwoDigitPosition",value:function(t){var e=t.toString(16);return 1===e.length&&(e="0"+e),e}},{key:"getFullSummary",value:function(){if(null==this.strokes)throw new Error("Strokes not available");var t="",e=!0,r=!1,n=void 0;try{for(var i,a=this.strokes[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var s=i.value;t.length>0&&(t+=":"),t+=this.getTwoDigitPosition(s.startX),t+=",",t+=this.getTwoDigitPosition(s.startY),t+="-",t+=this.getTwoDigitPosition(s.endX),t+=",",t+=this.getTwoDigitPosition(s.endY)}}catch(t){r=!0,n=t}finally{try{e||null==a.return||a.return()}finally{if(r)throw n}}return t}},{key:"write",value:function(){return new w(this.kanji,this.getFullSummary())}},{key:"getMatchScore",value:function(t,e){var r=this.comparers.get(e.key);return null==r&&(r=e.newComparer(this),this.comparers.set(e.key,r)),r.getMatchScore(t)}}],[{key:"parseHex",value:function(t){var e=parseInt(t,16);if(!isNaN(e))return e;throw new Error("NumberFormatException "+t)}},{key:"getTwoDigitHexInt",value:function(t,e){return this.parseHex(t.substring(e,e+2))}},{key:"fromFull",value:function(t,e){var r=new this(t),n=(e.length+1)/12;if(12*n-1!==e.length)throw new Error("Invalid full ("+e+") for kanji ("+t+")");try{r.strokes=[];for(var i=0,a=0;a<n;a++)0!==a&&i++,r.strokes[a]=b.fromInts(this.getTwoDigitHexInt(e,i),this.getTwoDigitHexInt(e,i+3),this.getTwoDigitHexInt(e,i+6),this.getTwoDigitHexInt(e,i+9)),i+=11}catch(r){throw new Error("Invalid summary("+e+") for kanji ("+t+")"+r)}return r.findDirections(),r}},{key:"fromDirectionsFull",value:function(t,e,r){var n=new this(t),i=(r.length+1)/12;if(i<1||6*i-3!==e.length)throw new Error("Invalid directions ("+e+") for kanji ("+t+")");if(12*i-1!==r.length)throw new Error("Invalid full ("+r+") for kanji ("+t+")");n.strokeDirections=[],n.strokeStarts=[],n.strokeEnds=[],n.moveDirections=[];try{for(var a=0,s=0;s<i;s++)0!==s&&(a++,n.moveDirections[s-1]=O.fromString(e.charAt(a++)+""),a++),n.strokeStarts[s]=y.fromString(e.charAt(a++)+""),n.strokeDirections[s]=O.fromString(e.charAt(a++)+""),n.strokeEnds[s]=y.fromString(e.charAt(a++)+"")}catch(r){throw new Error("Invalid strokes("+e+") for kanji ("+t+")")}try{n.strokes=[];for(var o=0,u=0;u<i;u++)0!==u&&o++,n.strokes[u]=b.fromInts(this.parseHex(r.substring(o,o+2)),this.parseHex(r.substring(o+3,o+5)),this.parseHex(r.substring(o+6,o+8)),this.parseHex(r.substring(o+9,o+11))),o+=11}catch(e){throw new Error("Invalid summary("+r+") for kanji ("+t+")"+e)}return n}}]),t}(),T=function(){function t(e,r){Object(s["a"])(this,t),this.kanjiInfo=e,this.score=r}return Object(u["a"])(t,null,[{key:"compare",value:function(e,r){return e.score>r.score?-1:e.score<r.score?1:t.strcmp(e.kanjiInfo.kanji,r.kanjiInfo.kanji)}},{key:"strcmp",value:function(t,e){return t<e?-1:t>e?1:0}}]),t}(),p=function(){function t(){Object(s["a"])(this,t),this.kanjiInfos=new Map,this.finished=!1}return Object(u["a"])(t,[{key:"isFinished",value:function(){return this.finished}},{key:"add",value:function(t){var e=t.getStrokeCount(),r=this.kanjiInfos.get(e);null==r&&(r=[],this.kanjiInfos.set(e,r)),r.push(t)}},{key:"finish",value:function(){this.kanjiInfos=new Map(Object(k["a"])(this.kanjiInfos).sort(function(t,e){return t[0]-e[0]})),this.finished=!0}},{key:"checkFinished",value:function(){if(!this.finished)throw new Error("Cannot call on unfinished kanji")}},{key:"getKanji",value:function(t){this.checkFinished();var e=this.kanjiInfos.get(t);return null==e?[]:e}},{key:"find",value:function(t){this.checkFinished();var e=!0,r=!1,n=void 0;try{for(var i,a=this.kanjiInfos.values()[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var s=i.value,o=!0,u=!1,h=void 0;try{for(var c,l=s[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;if(f.kanji===t)return f}}catch(t){u=!0,h=t}finally{try{o||null==l.return||l.return()}finally{if(u)throw h}}}}catch(t){r=!0,n=t}finally{try{e||null==a.return||a.return()}finally{if(r)throw n}}throw new Error("Kanji '"+t+"' not found")}},{key:"getTopMatches",value:function(t,e){this.checkFinished();var r=[],n=[];if(t.getStrokeCount()>0)for(var i=e.out,a=t.getStrokeCount()-i,s=0;s<2;s++){if(a>0){var o=this.kanjiInfos.get(a);null!=o&&n.push.apply(n,Object(k["a"])(o))}if(a+=2*i,0===i)break}for(var u=0;u<n.length;u++){var h=n[u],c=t.getMatchScore(h,e),l=new T(h,c);r.push(l)}r=r.sort(function(t,e){return T.compare(t,e)});var f=[],v=-1,d=!0,S=!1,O=void 0;try{for(var y,b=r[Symbol.iterator]();!(d=(y=b.next()).done);d=!0){var E=y.value;if(-1===v)v=E.score;else if(E.score<.75*v)break;f.push(E)}}catch(t){S=!0,O=t}finally{try{d||null==b.return||b.return()}finally{if(S)throw O}}return f}},{key:"load",value:function(t){this.kanjiInfos.clear();var e=!0,r=!1,n=void 0;try{for(var i,a=t[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var s=i.value;this.add(I.fromFull(s.kanji,s.strokes))}}catch(t){r=!0,n=t}finally{try{e||null==a.return||a.return()}finally{if(r)throw n}}this.finish()}},{key:"save",value:function(){this.checkFinished();var t=[],e=!0,r=!1,n=void 0;try{for(var i,a=this.kanjiInfos.values()[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var s=i.value,o=!0,u=!1,h=void 0;try{for(var c,l=s[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value,v=f.write();t.push(v)}}catch(t){u=!0,h=t}finally{try{o||null==l.return||l.return()}finally{if(u)throw h}}}}catch(t){r=!0,n=t}finally{try{e||null==a.return||a.return()}finally{if(r)throw n}}return t}}]),t}(),m=function(){function t(){Object(s["a"])(this,t)}return Object(u["a"])(t,[{key:"init",value:function(t){this.drawnStarts=t.strokeStarts,this.drawnEnds=t.strokeEnds,this.drawnDirections=t.strokeDirections,this.drawnMoves=t.moveDirections}},{key:"getMatchScore",value:function(e){var r=e.strokeStarts,n=e.strokeEnds,i=e.strokeDirections,a=e.moveDirections;if(r.length!==this.drawnStarts.length)throw new Error("Can only compare with same match length");for(var s=0,o=0;o<this.drawnStarts.length;o++)this.drawnDirections[o]===i[o]?s+=t.STROKE_DIRECTION_WEIGHT:this.drawnDirections[o].isClose(i[o])&&(s+=t.STROKE_DIRECTION_WEIGHT*t.CLOSE_WEIGHT),o>0&&(this.drawnMoves[o-1]===a[o-1]?s+=t.MOVE_DIRECTION_WEIGHT:this.drawnMoves[o-1].isClose(a[o-1])&&(s+=t.MOVE_DIRECTION_WEIGHT*t.CLOSE_WEIGHT)),this.drawnStarts[o]===r[o]?s+=t.STROKE_LOCATION_WEIGHT:this.drawnStarts[o].isClose(r[o])&&(s+=t.STROKE_LOCATION_WEIGHT*t.CLOSE_WEIGHT),this.drawnEnds[o]===n[o]?s+=t.STROKE_LOCATION_WEIGHT:this.drawnEnds[o].isClose(n[o])&&(s+=t.STROKE_LOCATION_WEIGHT*t.CLOSE_WEIGHT);var u=this.drawnStarts.length*(t.STROKE_DIRECTION_WEIGHT+2*t.STROKE_LOCATION_WEIGHT)+(this.drawnStarts.length-1)*t.MOVE_DIRECTION_WEIGHT;return 100*s/u}}]),t}();m.STROKE_DIRECTION_WEIGHT=1,m.MOVE_DIRECTION_WEIGHT=.8,m.STROKE_LOCATION_WEIGHT=.6,m.CLOSE_WEIGHT=.7;r("6c7b");var N=function(){function t(){Object(s["a"])(this,t)}return Object(u["a"])(t,[{key:"init",value:function(t){this.drawnPairs=this.convertKanjiInfo(t),this.drawnPoints=this.getPairPoints(this.drawnPairs);var e=!0,r=!1,n=void 0;try{for(var i,a=this.drawnPairs[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var s=i.value;s.initDrawn(this.drawnPairs.length+2)}}catch(t){r=!0,n=t}finally{try{e||null==a.return||a.return()}finally{if(r)throw n}}}},{key:"convertKanjiInfo",value:function(t){for(var e=[],r=0;r<t.getStrokeCount();r++){var n=t.getStroke(r);e[r]=new _(new C(n.startX,n.startY),new C(n.endX,n.endY))}for(var i=0;i<e.length;i++){var a=e[i];a.a.setPair(a),a.b.setPair(a)}return e}},{key:"getPairPoints",value:function(t){for(var e=new Array(2*t.length),r=0,n=0;n<t.length;n++)e[r++]=t[n].a,e[r++]=t[n].b;for(var i=0;i<e.length;i++){var a=e[i];a.count(e)}return e}},{key:"getMatchScore",value:function(t){var e=this.convertKanjiInfo(t),r=this.getPairPoints(e),n=6*Math.max(this.drawnPoints.length,r.length),i=!0,a=!1,s=void 0;try{for(var o,u=this.drawnPoints[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var h=o.value;h.calcScore(r,n)}}catch(t){a=!0,s=t}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}var c=!0,l=!1,f=void 0;try{for(var v,d=this.drawnPairs[Symbol.iterator]();!(c=(v=d.next()).done);c=!0){var S=v.value;S.calcScore(r)}}catch(t){l=!0,f=t}finally{try{c||null==d.return||d.return()}finally{if(l)throw f}}var k=this.drawnPairs.slice(),O=k.length,y=r.length,b=0;while(y>0&&O>0){for(var E=-1,g=null,w=-1,I=0;I<k.length;I++){var T=k[I];null!=T&&(T.scoreAvailable(r,w),T.bestScore>w&&(g=T,E=I,w=T.bestScore))}k[E]=null;var p=g.bestAIndex,m=g.bestBIndex;r[p]=null,r[m]=null,b+=w,O--,y-=2}return b/=2*n*(this.drawnPairs.length-O),100*b}}]),t}();N.SCOREMULTI_NOT_PAIR=.9,N.SCOREMULTI_WRONG_DIRECTION=.97,N.BEST_SCORES_SORT_FIRST=5;var _=function(){function t(e,r){Object(s["a"])(this,t),this.a=e,this.b=r,this.pointCount=0,this.maxBScore=0,this.maxAScore=0,this.bestScore=0,this.bestAIndex=0,this.bestBIndex=0}return Object(u["a"])(t,[{key:"initDrawn",value:function(t){this.scores=[];for(var e=0;e<2*t;e++)this.scores[e]=new Array(2*t).fill(0);this.a.initDrawn(t),this.b.initDrawn(t)}},{key:"calcScore",value:function(t){this.pointCount=t.length,this.maxBScore=-1,this.maxAScore=-1;for(var e=0;e<this.pointCount;e++){var r=this.b.score[e];r>this.maxBScore&&(this.maxBScore=r)}for(var n=0;n<this.pointCount;n++){var i=this.a.score[n];i>this.maxAScore&&(this.maxAScore=i);for(var a=t[n],s=a.pair,o=s.a!=a,u=0;u<this.pointCount;u++){var h=this.b.score[u];if(u!=n){var c=i+h;s!=t[u].pair?c*=N.SCOREMULTI_NOT_PAIR:o&&(c*=N.SCOREMULTI_WRONG_DIRECTION),this.scores[n][u]=c}}}this.bestScore=-1}},{key:"scoreAvailable",value:function(t,e){if(!(this.bestScore>0)&&!(this.maxAScore+this.maxBScore<e)){this.bestScore=-1;for(var r=0;r<this.pointCount;r++){var n=this.a.sortedScore[r],i=n.index;if(!(n.score+this.maxBScore<e||null==t[i]))for(var a=this.scores[i],s=0;s<this.pointCount;s++){var o=this.b.sortedScore[s],u=o.index;if(u!=i&&null!=t[u]){var h=a[u];h>this.bestScore&&(this.bestScore=h,this.bestAIndex=i,this.bestBIndex=u,this.bestScore>e&&(e=this.bestScore))}}}}}}]),t}(),R=function(){function t(){Object(s["a"])(this,t),this.score=0,this.index=0,this.used=!1}return Object(u["a"])(t,null,[{key:"compare",value:function(t,e){return e.score>t.score?1:e.score<t.score?-1:t.index-e.index}}]),t}(),C=function(){function t(e,r){Object(s["a"])(this,t),this.x=0,this.y=0,this.xLess=0,this.xMore=0,this.xSimilar=0,this.yLess=0,this.yMore=0,this.ySimilar=0,this.best=new Array(N.BEST_SCORES_SORT_FIRST).fill(0),this.x=Math.trunc(255*(e+.5)),this.y=Math.trunc(255*(r+.5))}return Object(u["a"])(t,[{key:"setPair",value:function(t){this.pair=t}},{key:"count",value:function(e){var r=!0,n=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var o=a.value;o!==this&&(o.x<this.x-t.SIMILAR_RANGE?this.xLess++:o.x>this.x+t.SIMILAR_RANGE?this.xMore++:this.xSimilar++,o.y<this.y-t.SIMILAR_RANGE?this.yLess++:o.y>this.y+t.SIMILAR_RANGE?this.yMore++:this.ySimilar++)}}catch(t){n=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}}},{key:"initDrawn",value:function(t){this.score=new Array(2*t),this.sortedScore=new Array(2*t),this.preSortedScore=new Array(2*t+1);for(var e=0;e<2*t;e++)this.preSortedScore[e]=new R;this.preSortedScore[2*t]=new R}},{key:"calcScore",value:function(t,e){this.stage1(t,e),this.stage2(),this.stage3(t)}},{key:"stage1",value:function(t,e){for(var r=0;r<N.BEST_SCORES_SORT_FIRST;r++)this.best[r]=this.preSortedScore.length-1;for(var n=0,i=0;i<t.length;i++){var a=this.calcThisScore(e,t[i]),s=this.preSortedScore[i];if(s.index=i,s.score=a,s.used=!1,this.score[i]=a,a>=n){var o=this.stage1a(a);this.stage1b(o),this.best[o]=i,o==N.BEST_SCORES_SORT_FIRST-1&&(n=a)}}}},{key:"calcThisScore",value:function(t,e){var r=Math.abs(this.xLess-e.xLess)+Math.abs(this.xMore-e.xMore)+Math.abs(this.xSimilar-e.xSimilar)+Math.abs(this.yLess-e.yLess)+Math.abs(this.yMore-e.yMore)+Math.abs(this.ySimilar-e.ySimilar),n=t-r;return n}},{key:"stage1a",value:function(t){for(var e=0;e<N.BEST_SCORES_SORT_FIRST-1;e++)if(t>this.preSortedScore[this.best[e]].score)return e;return e}},{key:"stage1b",value:function(t){for(var e=N.BEST_SCORES_SORT_FIRST-1;e>t;e--)this.best[e]=this.best[e-1]}},{key:"stage2",value:function(){for(var t=0;t<N.BEST_SCORES_SORT_FIRST;t++){var e=this.preSortedScore[this.best[t]];this.sortedScore[t]=e,e.used=!0}}},{key:"stage3",value:function(t){for(var e=N.BEST_SCORES_SORT_FIRST,r=0;r<t.length;r++){var n=this.preSortedScore[r];n.used||(this.sortedScore[e++]=n)}}}]),t}();C.SIMILAR_RANGE=13;r("4917");var A=function(){function t(){Object(s["a"])(this,t),this.count=0}return Object(u["a"])(t,[{key:"init",value:function(e){this.positions=[];for(var r=0;r<t.ARRAY_SIZE;r++)this.positions[r]=new x;this.count=e.getStrokeCount();for(var n=0;n<this.count;n++){var i=e.getStroke(n),a=i.startX*t.LOCATION_RANGE>>8,s=i.startY*t.LOCATION_RANGE>>8,o=i.endX*t.LOCATION_RANGE>>8,u=i.endY*t.LOCATION_RANGE>>8;this.addSpan(n,a,s,o,u,!0),this.addSpan(n,o,u,a,s,!1)}for(var h=0;h<t.ARRAY_SIZE;h++)this.positions[h].finish()}},{key:"getIndex",value:function(e,r,n,i){return e*t.LOCATION_RANGE*t.LOCATION_RANGE*t.LOCATION_RANGE+r*t.LOCATION_RANGE*t.LOCATION_RANGE+n*t.LOCATION_RANGE+i}},{key:"addSpan",value:function(e,r,n,i,a,s){for(var o=r-1;o<=r+1;o++)if(!(o<0||o>=t.LOCATION_RANGE))for(var u=n-1;u<=n+1;u++)if(!(u<0||u>=t.LOCATION_RANGE))for(var h=i-1;h<=i+1;h++)if(!(h<0||h>=t.LOCATION_RANGE))for(var c=a-1;c<=a+1;c++)if(!(c<0||c>=t.LOCATION_RANGE)){var l=void 0;l=r===o&&n===u?t.SCORE_EXACTLOCATION:r===o||n===u?t.SCORE_STRAIGHTLOCATION:t.SCORE_DIAGONALLOCATION,l+=i===h&&a===c?t.SCORE_EXACTLOCATION:i===h||a===c?t.SCORE_STRAIGHTLOCATION:t.SCORE_DIAGONALLOCATION,s&&(l+=t.SCORE_RIGHTDIRECTION),this.positions[this.getIndex(o,u,h,c)].add(e,l)}}},{key:"getMatchScore",value:function(e){for(var r=[],n=this.count,i=e.getStrokeCount(),a=i,s=[],o=[],u=0;u<i;u++){var h=e.getStroke(u),c=h.startX*t.LOCATION_RANGE>>8,l=h.startY*t.LOCATION_RANGE>>8,f=h.endX*t.LOCATION_RANGE>>8,v=h.endY*t.LOCATION_RANGE>>8;o[u]=this.getIndex(c,l,f,v)}for(var d=0,S=t.MAX_SCORE;S>=t.MIN_SCORE;S--)for(var k=0;k<i;k++)if(!s[k]){var O=this.positions[o[k]].match(S,r);if(O!==t.NO_MATCH&&(d+=S,s[k]=!0,r[O]=!0,n--,a--,0===n||0===a))break}var y=Math.min(this.count,i)*t.MAX_SCORE;return d/y*100}}]),t}();A.LOCATION_RANGE=5,A.ARRAY_SIZE=A.LOCATION_RANGE*A.LOCATION_RANGE*A.LOCATION_RANGE*A.LOCATION_RANGE,A.SCORE_RIGHTDIRECTION=2,A.SCORE_EXACTLOCATION=4,A.SCORE_STRAIGHTLOCATION=3,A.SCORE_DIAGONALLOCATION=2,A.MAX_SCORE=2*A.SCORE_EXACTLOCATION+A.SCORE_RIGHTDIRECTION,A.MIN_SCORE=2*A.SCORE_DIAGONALLOCATION,A.NO_MATCH=-1;var j=function(){function t(e,r){Object(s["a"])(this,t),this.stroke=e,this.score=r}return Object(u["a"])(t,null,[{key:"compare",value:function(t,e){return e.score>t.score?1:e.score<t.score?-1:e.stroke-t.stroke}}]),t}(),x=function(){function t(){Object(s["a"])(this,t),this.spanSet=[]}return Object(u["a"])(t,[{key:"add",value:function(t,e){this.spanSet.push(new j(t,e))}},{key:"finish",value:function(){this.spanScores=this.spanSet.sort(function(t,e){return j.compare(t,e)}),this.spanSet=null}},{key:"match",value:function(t,e){var r=!0,n=!1,i=void 0;try{for(var a,s=this.spanScores[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var o=a.value;if(o.score<t)return A.NO_MATCH;if(!e[o.stroke])return o.stroke}}catch(t){n=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}return A.NO_MATCH}}]),t}(),L=function(){function t(e,r,n){Object(s["a"])(this,t),this.key=e,this.out=r,this.ctor=n}return Object(u["a"])(t,[{key:"newComparer",value:function(t){var e;try{e=new this.ctor}catch(t){throw new Error("Incorrectly defined comparer")}return e.init(t),e}}]),t}();L.STRICT=new L("STRICT",0,m),L.FUZZY=new L("FUZZY",0,N),L.FUZZY_1OUT=new L("FUZZY_1OUT",1,N),L.FUZZY_2OUT=new L("FUZZY_2OUT",2,N),L.SPANS=new L("SPANS",0,A),L.SPANS_1OUT=new L("SPANS_1OUT",1,A),L.SPANS_2OUT=new L("SPANS_2OUT",2,A);var D=function(t){function e(){var t;Object(s["a"])(this,e),t=Object(h["a"])(this,Object(c["a"])(e).call(this)),t.isLoading=!0,t.message="Loading",t.variant="700",t.variantOutline="outline-700",t.clearDisabled=!0,t.undoDisabled=!0,t.algoText="FUZZY",t.kanjiResults1=[],t.kanjiResults2=[],t.kanjiResults3=[],t.inputStrokes=[],t.jpws="　";for(var r="手書き入力された漢字に対応する候補漢字がここに表示されます。",n=0;n<10;n++)t.kanjiResults1.push({index:n,kanji:r[n]}),t.kanjiResults2.push({index:n,kanji:r[n+10]}),t.kanjiResults3.push({index:n,kanji:r[n+20]});return t}return Object(u["a"])(e,[{key:"clear",value:function(){this.pad.clear(),this.inputStrokes=[],this.clearKanjiResults()}},{key:"undo",value:function(){var t=this.pad.toData();if(t){t.pop(),this.inputStrokes.pop(),this.pad.fromData(t);var e=this.inputStrokes.length>0;this.undoDisabled=this.clearDisabled=!e,e?this.searchKanji():this.clearKanjiResults()}}},{key:"clearKanjiResults",value:function(){var t=this;this.kanjiResults1.forEach(function(e){return e.kanji=t.jpws}),this.kanjiResults2.forEach(function(e){return e.kanji=t.jpws}),this.kanjiResults3.forEach(function(e){return e.kanji=t.jpws})}},{key:"searchKanji",value:function(){var t=new I("?"),e=!0,r=!1,n=void 0;try{for(var i,a=this.inputStrokes[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var s=i.value;t.addStroke(s)}}catch(t){r=!0,n=t}finally{try{e||null==a.return||a.return()}finally{if(r)throw n}}t.finish();var o=this.kanjiList.getTopMatches(t,L.FUZZY).slice(0,30);console.log(o);for(var u=0;u<10;u++)this.kanjiResults1[u].kanji=o[u]?o[u].kanjiInfo.kanji:this.jpws,this.kanjiResults2[u].kanji=o[u+10]?o[u+10].kanjiInfo.kanji:this.jpws,this.kanjiResults3[u].kanji=o[u+20]?o[u+20].kanjiInfo.kanji:this.jpws}},{key:"mounted",value:function(){var t=this;this.$nextTick(function(){window.addEventListener("resize",t.resizeCanvas),t.canvas=t.$refs.signaturePadCanvas,t.pad=new v["a"](t.canvas,{onBegin:function(e){t.startX=e.clientX,t.startY=e.clientY},onEnd:function(e){t.endX=e.clientX,t.endY=e.clientY,t.undoDisabled=t.clearDisabled=!1;var r=g.fromFloats(t.startX,t.startY,t.endX,t.endY);t.inputStrokes.push(r),t.searchKanji()}}),t.fetchKanjiList().then(function(e){e.isFinished()&&(t.kanjiList=e,t.isLoading=!1,t.$nextTick(function(){t.resizeCanvas()}))})})}},{key:"resizeCanvas",value:function(){var t=Math.max(window.devicePixelRatio||1,1);this.canvas.width=this.canvas.offsetWidth*t,this.canvas.height=this.canvas.offsetHeight*t,this.canvas.getContext("2d").scale(t,t),this.pad.clear()}},{key:"copyKanji",value:function(t){if(t){var e=document.createElement("textarea");e.value=t,e.style.cssText="position:fixed;pointer-events:none;z-index:-9999;opacity:0",document.body.appendChild(e),e.select();try{document.execCommand("copy")}catch(t){console.warn(t)}document.body.removeChild(e)}}},{key:"fetchKanjiList",value:function(){return new Promise(function(t,e){var r=new XMLHttpRequest,n="data/strokes.dat";r.open("GET",n,!0),r.responseType="arraybuffer",r.send(),r.onload=function(n){if(r.status>0&&200!==r.status)e({status:r.status,statusText:r.statusText});else{var i=r.response,a=S.a.inflate(new Uint8Array(i),{to:"string"}),s=JSON.parse(a),o=new p;o.load(s),console.log(o.getKanji(1)),t(o)}}})}}]),Object(o["a"])(e,t),e}(f["b"]);D=l["a"]([Object(f["a"])({})],D);var M=D,G=M,X=(r("d678"),r("2877")),H=Object(X["a"])(G,i,a,!1,null,null,null);H.options.__file="App.vue";var Y=H.exports,P=r("9f7b");n["default"].use(P["a"]),n["default"].config.productionTip=!1,new n["default"]({render:function(t){return t(Y)}}).$mount("#app")}});
//# sourceMappingURL=index.599f3d75.js.map